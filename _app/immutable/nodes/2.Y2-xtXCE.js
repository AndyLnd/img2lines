import{f as B,b as F}from"../chunks/BP6hl8o5.js";import{i as G}from"../chunks/DthKUD94.js";import{a0 as H,a1 as J,a2 as j,w as x,a3 as K,r as W,t as Y,J as z,E as g,y as Q,N as p,L as X,M as Z,a4 as v,a5 as _}from"../chunks/DE0N6yax.js";import{l as $,e as tt}from"../chunks/UQLerqxQ.js";import{b as N}from"../chunks/BcoqvRQF.js";const nt=Symbol("is custom element"),st=Symbol("is html");function w(t,n,s,a){var e=at(t);x&&(e[n]=t.getAttribute(n),n==="src"||n==="srcset"||n==="href"&&t.nodeName==="LINK")||e[n]!==(e[n]=s)&&(n==="loading"&&(t[H]=s),s==null?t.removeAttribute(n):typeof s!="string"&&et(t).includes(n)?t[n]=s:t.setAttribute(n,s))}function at(t){return t.__attributes??(t.__attributes={[nt]:t.nodeName.includes("-"),[st]:t.namespaceURI===J})}var T=new Map;function et(t){var n=T.get(t.nodeName);if(n)return n;T.set(t.nodeName,n=[]);for(var s,a=t,e=Element.prototype;e!==a;){s=K(a);for(var o in s)s[o].set&&n.push(o);a=j(a)}return n}function ot(t,n,s=n){$(t,"change",()=>{s(t.files)}),x&&t.files&&s(t.files),W(()=>{t.files=n()})}const E=(t,n,s)=>{const a=t/n*Math.PI*2;return{x:Math.sin(a)*s,y:-Math.cos(a)*s}};function b(t){t.fillStyle="#fff",t.fillRect(0,0,t.canvas.width,t.canvas.height)}function A(t,n,s,a=.5){const e=t.canvas.width/2,o=t.canvas.height/2,i=Math.min(e,o)-10;t.lineJoin="round",t.lineWidth=a,t.beginPath();const{x:c,y:r}=E(s[0],n,i);t.moveTo(c+e,r+o);for(let d=1;d<s.length;d++){const{x:y,y:h}=E(s[d],n,i);t.lineTo(y+e,h+o)}t.stroke()}function D(t){const{width:n,height:s}=t.canvas,a=t.getImageData(0,0,n,s).data,e=new Uint8ClampedArray(a.length/4);for(let o=0;o<a.length;o+=4){const i=a[o],c=a[o+1],r=a[o+2];e[o/4]=i*.3+c*.6+r*.1}return e}function it(t,n){const s=Math.min(t.length,n.length);let a=0;for(let e=0;e<s;e++)a+=(t[e]-n[e])**2;return a}function rt(t){const n=t.reduce((e,o)=>o<e?o:e,t[0]),a=255/(t.reduce((e,o)=>o>e?o:e,t[0])-n);return t.map(e=>(e-n)*a)}const ct=(t,n)=>Array(t-1).fill(0).map((s,a)=>[(n+a+1)%t]);function ft(t,n,s,a,e){const o=s.map(c=>{b(a),A(a,t,[...n,...c],.2);const r=D(a);return it(r,e)}),i=o.reduce((c,r,d)=>r<o[c]?d:c,0);return s[i]}function P(t){const n=document.createElement("canvas");return n.width=t,n.height=t,n.getContext("2d",{willReadFrequently:!0})}function dt(t){return new Promise(n=>{const s=new Image;s.onload=()=>n(s),s.src=URL.createObjectURL(t)})}async function lt(t,n){const s=P(n),a=await dt(t);return s.drawImage(a,0,0),s}var gt=B('<input type="file"/> <div><button>go</button></div> <div></div> <canvas></canvas> <canvas></canvas>',1);function wt(t,n){Y(n,!1);let s=v(),a=v(),e=v(),o=v();const i=200,c=1e3,r=128,d=20;async function y(){const f=g(o)[0],S=await lt(f,i);g(s).getContext("2d").drawImage(S.canvas,0,0);const U=rt(D(S)),O=P(i),m=g(a).getContext("2d"),l=[0];for(;l.length<c;){const V=l.at(-1),q=ct(r,V),k=ft(r,l,q,O,U);l.push(...k),l.length%d===0&&(await new Promise(requestAnimationFrame),b(m),A(m,r,l,1))}b(m),A(m,r,l,1),console.log("done")}G();var h=gt(),I=z(h),C=p(I,2),R=X(C);Z(C);var L=p(C,2);N(L,f=>_(e,f),()=>g(e));var u=p(L,2);w(u,"width",i*3),w(u,"height",i*3),N(u,f=>_(a,f),()=>g(a));var M=p(u,2);w(M,"width",i),w(M,"height",i),N(M,f=>_(s,f),()=>g(s)),ot(I,()=>g(o),f=>_(o,f)),tt("click",R,y),F(t,h),Q()}export{wt as component};

import{f as K,b as $}from"../chunks/Bs9UZHtT.js";import{i as j}from"../chunks/6qnzYKYY.js";import{a0 as J,a1 as W,a2 as Y,w as U,a3 as z,r as Q,t as X,K as Z,E as l,y as tt,L as v,M as p,N as _,a4 as w,a5 as y,u as nt,a6 as et}from"../chunks/DC8TlEyK.js";import{l as st,e as at}from"../chunks/_Zn-vQ2v.js";import{b as A}from"../chunks/_qgIZdzR.js";const ot=Symbol("is custom element"),it=Symbol("is html");function b(t,n,e,s){var a=rt(t);U&&(a[n]=t.getAttribute(n),n==="src"||n==="srcset"||n==="href"&&t.nodeName==="LINK")||a[n]!==(a[n]=e)&&(n==="loading"&&(t[J]=e),e==null?t.removeAttribute(n):typeof e!="string"&&ct(t).includes(n)?t[n]=e:t.setAttribute(n,e))}function rt(t){return t.__attributes??(t.__attributes={[ot]:t.nodeName.includes("-"),[it]:t.namespaceURI===W})}var P=new Map;function ct(t){var n=P.get(t.nodeName);if(n)return n;P.set(t.nodeName,n=[]);for(var e,s=t,a=Element.prototype;a!==s;){e=z(s);for(var o in e)e[o].set&&n.push(o);s=Y(s)}return n}function dt(t,n,e=n){st(t,"change",()=>{e(t.files)}),U&&t.files&&e(t.files),Q(()=>{t.files=n()})}const R=(t,n,e)=>{const s=t/n*Math.PI*2;return{x:Math.sin(s)*e,y:-Math.cos(s)*e}};function I(t){t.fillStyle="#fff",t.fillRect(0,0,t.canvas.width,t.canvas.height)}function L(t,n,e,s=.5){const a=t.canvas.width/2,o=t.canvas.height/2,i=Math.min(a,o)-10;t.lineJoin="round",t.lineWidth=s,t.beginPath();const{x:d,y:r}=R(e[0],n,i);t.moveTo(d+a,r+o);for(let g=1;g<e.length;g++){const{x:C,y:u}=R(e[g],n,i);t.lineTo(C+a,u+o)}t.stroke()}function O(t){const{width:n,height:e}=t.canvas,s=t.getImageData(0,0,n,e).data,a=new Uint8ClampedArray(s.length/4);for(let o=0;o<s.length;o+=4){const i=s[o],d=s[o+1],r=s[o+2];a[o/4]=i*.3+d*.6+r*.1}return a}function lt(t,n){const e=Math.min(t.length,n.length);let s=0;for(let a=0;a<e;a++)s+=(t[a]-n[a])**2;return s}function ft(t){const n=t.reduce((a,o)=>o<a?o:a,t[0]),s=255/(t.reduce((a,o)=>o>a?o:a,t[0])-n);return t.map(a=>(a-n)*s)}const gt=(t,n)=>Array(t-1).fill(0).map((e,s)=>[(n+s+1)%t]);function ut(t,n,e,s,a){const o=e.map(d=>{I(s),L(s,t,[...n,...d],.2);const r=O(s);return lt(r,a)}),i=o.reduce((d,r,g)=>r<o[d]?g:d,0);return e[i]}function V(t){const n=document.createElement("canvas");return n.width=t,n.height=t,n.getContext("2d",{willReadFrequently:!0})}function ht(t){return new Promise(n=>{const e=new Image;e.onload=()=>n(e),e.src=URL.createObjectURL(t)})}async function mt(t,n){const e=V(n),s=await ht(t);return e.drawImage(s,0,0),e}var vt=K('<div class="p-8 flex flex-col gap-4"><div><input class="bg-emerald-200 border border-emerald-800 rounded p-4 inline" type="file"/></div> <div><button class="bg-emerald-200 p-2 border border-emerald-800 rounded min-w-2xs disabled:opacity-50">go</button></div> <div></div> <div class="flex items-center"><canvas></canvas> <canvas></canvas></div></div>');function Mt(t,n){X(n,!1);let e=w(),s=w(),a=w(),o=w();const i=200,d=1e3,r=128,g=20;async function C(){const c=l(o)[0],D=await mt(c,i);l(e).getContext("2d").drawImage(D.canvas,0,0);const q=ft(O(D)),B=V(i),m=l(s).getContext("2d"),f=[0];for(;f.length<d;){const F=f.at(-1),G=gt(r,F),H=ut(r,f,G,B,q);f.push(...H),f.length%g===0&&(await new Promise(requestAnimationFrame),et(a,l(a).textContent=`${f.length} / ${d}`),I(m),L(m,r,f,1))}I(m),L(m,r,f,1),console.log("done")}j();var u=vt(),M=v(u),k=v(M);p(M);var x=_(M,2),S=v(x);p(x);var T=_(x,2);A(T,c=>y(a,c),()=>l(a));var E=_(T,2),h=v(E);b(h,"width",i),b(h,"height",i),A(h,c=>y(e,c),()=>l(e));var N=_(h,2);b(N,"width",i*3),b(N,"height",i*3),A(N,c=>y(s,c),()=>l(s)),p(E),p(u),Z(()=>S.disabled=(l(o),nt(()=>{var c;return((c=l(o))==null?void 0:c.length)<1}))),dt(k,()=>l(o),c=>y(o,c)),at("click",S,C),$(t,u),tt()}export{Mt as component};
